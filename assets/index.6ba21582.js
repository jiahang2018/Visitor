import{_ as ee,h as te,i as ae,I as ie,j as ne,u as oe,k as g,l as h,r as w,J as le,o as m,c as _,a as r,Q as se,d as i,w as o,K as T,R as L,e as d,t as n,b as B,x as F,z as E,S as A,E as U}from"./index.e44e980c.js";import{g as re,b as z}from"./visitorInfo.b5dce02e.js";import{R as de,T as ue}from"./index.e8afee02.js";import{S as me}from"./Search.03289266.js";const ce={class:"layout-container"},ve={class:"query-condition"},pe={class:"pi-flex-sub"},fe={class:"layout-container-form-search"},we={class:"condition-footer"},_e={class:"layout-container-table"},ye={class:"s-flex-column"},ge={class:"s-fw-600"},he={key:0,class:"s-flex-column"},Ve={class:"s-fw-600"},Ne={key:1},be={class:"s-flex-column"},$e={key:0},ke={key:0},Ie={key:1},Ce={__name:"index",setup(Te){const l=te(),q=ae(),j=ie(()=>q.state.user),{UserID:b,token:$}=j.value;ne();const P=oe(),c=g({index:1,size:20,total:0}),k=new Date,D=k.getFullYear(),x=String(k.getMonth()+1).padStart(2,"0"),S=String(k.getDate()).padStart(2,"0"),Q=`${D}-${x}-${S}`,G=`${D}-${x}-${S}`;h([Q,G]);const s=h({LastName:"",MiddleName:"",FirstName:"",VisitorCompany:""});l.t("i18n.nearlyAWeek"),l.t("i18n.nearlyAMonth"),l.t("i18n.inTheLastThreeMonths");const R=h([]),I=g({1:{type:"warning",text:l.t("i18n.toBeExamined")},0:{type:"success",text:l.t("i18n.hasAgreed")},2:{type:"danger",text:l.t("i18n.rejected")}});g({input:""}),g({title:l.t("i18n.newVisitors"),show:!1,showButton:!1});const V=h(!1);function v(){let a=g({ItemCount:c.size,PageNumber:c.index,LastName:s.value.LastName,MiddleName:s.value.MiddleName,FirstName:s.value.FirstName,VisitorCompany:s.value.VisitorCompany,Visitor:!0,Review:[1]});V.value=!0,re({UserID:b,token:$,data:a}).then(e=>{V.value=!1,e.data.IsSuccess&&(R.value=e.data.data.holders,c.total=e.data.data.TotalItemCount,c.size=e.data.data.ItemCount,c.index=e.data.data.PageNumber)}).catch(()=>{V.value=!1})}const H=a=>{A.confirm(l.t("i18n.confirmConsent"),l.t("i18n.prompt"),{confirmButtonText:l.t("i18n.confirm"),cancelButtonText:l.t("i18n.cancel"),type:"warning"}).then(()=>{z({UserID:b,token:$,data:{Review:0,VisitorID:[a.ID],ReviewRemark:""}}).then(e=>{e.data.IsSuccess&&U({message:l.t("i18n.approvedAndApproved"),type:"success"}),v()})}).catch(()=>{})},J=a=>{A.prompt(l.t("i18n.confirmConsent"),l.t("i18n.prompt"),{confirmButtonText:l.t("i18n.confirm"),cancelButtonText:l.t("i18n.cancel")}).then(e=>{z({UserID:b,token:$,data:{Review:2,VisitorID:[a.ID],ReviewRemark:e.value}}).then(p=>{p.data.IsSuccess&&U({message:l.t("i18n.rejected1"),type:"success"}),v()})}).catch(()=>{})},M=a=>{P.push({name:"Detail",params:{id:a.ID}})},y=h("50px");function K(){y.value="100px"}function O(){y.value="50px"}function W(){s.value.LastName="",s.value.MiddleName="",s.value.FirstName="",s.value.VisitorCompany="",v()}return v(),(a,e)=>{const p=w("el-input"),N=w("el-form-item"),Y=w("el-form"),u=w("el-button"),f=w("el-table-column"),X=w("el-tag"),Z=le("loading");return m(),_("div",ce,[r("div",ve,[r("div",{class:"condition flex",style:se({height:y.value})},[r("div",pe,[i(Y,{model:s.value,"label-width":"auto",class:"s-flex1"},{default:o(()=>[i(N,{label:a.$t("i18n.visitorLastName")},{default:o(()=>[i(p,{style:{width:"260px"},modelValue:s.value.LastName,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.LastName=t)},null,8,["modelValue"])]),_:1},8,["label"]),i(N,{label:a.$t("i18n.visitorMiddleName")},{default:o(()=>[i(p,{style:{width:"260px"},modelValue:s.value.MiddleName,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.MiddleName=t)},null,8,["modelValue"])]),_:1},8,["label"]),i(N,{label:a.$t("i18n.visitorName")},{default:o(()=>[i(p,{style:{width:"260px"},modelValue:s.value.FirstName,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.FirstName=t)},null,8,["modelValue"])]),_:1},8,["label"]),i(N,{label:a.$t("i18n.companyName")},{default:o(()=>[i(p,{style:{width:"260px"},modelValue:s.value.VisitorCompany,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.VisitorCompany=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),r("div",fe,[T(i(u,{onClick:K},{default:o(()=>[d(n(a.$t("i18n.deployment")),1)]),_:1},512),[[L,y.value==="50px"]]),T(i(u,{onClick:O},{default:o(()=>[d(n(a.$t("i18n.putItAway")),1)]),_:1},512),[[L,y.value==="100px"]])])],4),r("div",we,[i(u,{type:"primary",onClick:e[4]||(e[4]=t=>v()),icon:B(me)},{default:o(()=>[d(n(a.$t("i18n.query")),1)]),_:1},8,["icon"]),i(u,{type:"warning",onClick:e[5]||(e[5]=t=>W()),icon:B(de)},{default:o(()=>[d(n(a.$t("i18n.reset")),1)]),_:1},8,["icon"])])]),r("div",_e,[T((m(),F(ue,{page:c,"onUpdate:page":e[6]||(e[6]=t=>c=t),onGetTableData:v,data:R.value,ref:"table"},{default:o(()=>[i(f,{prop:"LastName",label:a.$t("i18n.visitorInformation"),align:"center",width:"200"},{default:o(t=>[r("div",ye,[r("span",ge,n(t.row.LastName)+" "+n(t.row.MiddleName)+" "+n(t.row.FirstName),1),r("span",null,n(t.row.Email),1)])]),_:1},8,["label"]),i(f,{prop:"visitorInfo.VisitorCompany",label:a.$t("i18n.companyName"),align:"center","show-overflow-tooltip":""},null,8,["label"]),i(f,{prop:"nameOfInterviewee",label:a.$t("i18n.intervieweeInformation"),align:"center",width:"200"},{default:o(t=>[t.row.visitorInfo!==null?(m(),_("div",he,[r("span",Ve,n(t.row.visitorInfo.VisitedLastName)+" "+n(t.row.visitorInfo.VisitedMiddleName)+" "+n(t.row.visitorInfo.VisitedFirstName),1),r("span",null,n(t.row.visitorInfo.VisitedEmail),1)])):(m(),_("div",Ne,"--"))]),_:1},8,["label"]),i(f,{prop:"ValidStartTime",label:a.$t("i18n.approachTime"),align:"center",width:"270"},{default:o(t=>[r("div",be,[r("span",null,n(a.$t("i18n.visitingTime"))+"\uFF1A "+n(t.row.ValidStartTime),1),r("span",null,n(a.$t("i18n.departureTime"))+"\uFF1A "+n(t.row.ValidEndTime),1)])]),_:1},8,["label"]),i(f,{prop:"Review",label:a.$t("i18n.auditStatus"),align:"center"},{default:o(t=>[t.row.visitorInfo!==null?(m(),_("div",$e,[I[t.row.visitorInfo.Review]?(m(),F(X,{key:0,class:"ml-2",type:I[t.row.visitorInfo.Review].type},{default:o(()=>[d(n(I[t.row.visitorInfo.Review].text),1)]),_:2},1032,["type"])):E("",!0)])):E("",!0)]),_:1},8,["label"]),i(f,{fixed:"right",label:a.$t("i18n.operation"),align:"center",width:"225"},{default:o(t=>[t.row.visitorInfo!==null?(m(),_("div",ke,[i(u,{onClick:C=>H(t.row),type:"success",link:""},{default:o(()=>[d(n(a.$t("i18n.iAgree")),1)]),_:2},1032,["onClick"]),i(u,{onClick:C=>J(t.row),type:"danger",link:""},{default:o(()=>[d(n(a.$t("i18n.refuse")),1)]),_:2},1032,["onClick"]),i(u,{onClick:C=>M(t.row),type:"primary",link:""},{default:o(()=>[d(n(a.$t("i18n.viewDetails")),1)]),_:2},1032,["onClick"])])):(m(),_("div",Ie,[i(u,{onClick:C=>M(t.row),type:"primary",link:""},{default:o(()=>[d(n(a.$t("i18n.viewDetails")),1)]),_:2},1032,["onClick"])]))]),_:1},8,["label"])]),_:1},8,["page","data"])),[[Z,V.value]])])])}}};var Me=ee(Ce,[["__scopeId","data-v-9a2c6238"]]);export{Me as default};
